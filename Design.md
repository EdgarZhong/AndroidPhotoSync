# AndroidPhotoSync 设计文档

## 产品定位
- 面向无技术背景用户的 Windows 照片同步工具  
- 单 exe 即可运行，内置所有依赖  
- GUI 与核心逻辑解耦，但对用户表现为一个简单应用  

## 设计原则（极简）
- 默认安全：不删除手机源文件、不改写相册结构  
- 默认简单：插上手机即可完成一次同步  
- 默认可靠：断线可恢复、重复不拷贝  
- 默认可携带：单 exe，零安装  
- 默认扩展：核心最小化，扩展能力预留  

## 核心功能（最小可用）
- 设备连接与授权识别  
- 内置 ADB 依赖与自动调用  
- 备份目录选择  
- 一键同步核心相册目录  
- 增量同步与去重  
- 冲突处理与保留两份  
- 断点续传  
- 完整性校验  
- 日志与结果摘要  
- 配置持久化  

## 核心交互要点（GUI 现代极简）
- 主页只保留三个动作：连接设备、选择备份目录、开始同步  
- 状态区域只展示设备状态、进度、结果摘要  
- 视觉风格现代、留白、低噪声，避免技术术语  

## 核心同步策略
- 默认单向：手机 -> PC  
- 默认不删除手机文件  
- 默认只处理照片与视频  
- 默认目标目录为用户选择路径  

## 核心流程
- 发现设备并校验授权  
- 启动内置 ADB 通道  
- 扫描核心相册目录  
- 读取本地索引  
- 生成增量计划  
- 传输与校验  
- 更新索引与日志  

## 核心数据模型（概念层）
- 设备：唯一标识、授权状态、连接状态  
- 目录映射：手机路径、PC 目标路径  
- 文件项：路径、大小、修改时间、哈希、状态  
- 同步任务：任务 id、设备、映射集合、进度、统计  

## 扩展点（非核心功能全部放入此处）
- 通道扩展：rsync、MTP、Wi-Fi 传输  
- 规则扩展：按时间范围、相册选择、排除规则  
- 策略扩展：双向同步、删除策略  
- 任务扩展：定时任务、后台监控  
- 体验扩展：同步前预览、相册分类展示  
- 诊断扩展：更多统计、性能图表  

## 技术栈（内置依赖方案）
- 语言：C#  
- 运行时：.NET 8 自包含单文件发布  
- GUI：WPF，内置现代化主题风格  
- 核心逻辑：独立类库，提供统一接口供 GUI 调用  
- ADB：内置 platform-tools 并由核心逻辑管理调用  
- 配置与索引：本地文件存储  

## 目录结构规划
- /src/AndroidPhotoSync.Core  
- /src/AndroidPhotoSync.Gui  
- /src/AndroidPhotoSync.Infrastructure  
- /resources/platform-tools  
- /tests/AndroidPhotoSync.Tests  

## 迭代计划
- 里程碑 0.1：完成最小可用核心功能与一键同步  
- 里程碑 0.2：完善断点续传、冲突处理与日志  
- 里程碑 0.3：性能优化与核心稳定性打磨  
- 扩展阶段：按扩展点逐项实现  

## 参考与灵感来源
- adb-sync  
- adbsync-windows  
- rsync-for-android  
